# torchrun --nproc_per_node 4 train_gpt2_hf.py --size 10 --precision bf16
# torchrun --nproc_per_node 4 train_gpt2_hf.py --size 10 --precision block_int8 --quantise_weight
# torchrun --nproc_per_node 4 train_gpt2_hf.py --size 30 --precision block_int8 --quantise_weight
# torchrun --nproc_per_node 4 train_gpt2_hf.py --size 30 --precision bf16

# nearest 2
python train_gpt2_hf.py --size 30 --precision finegrain \
    --fnumber 2 --bnumber 2 --wnumber 2 --bwnumber 2 --bfnumber 2 \
    --frounding nearest --brounding nearest --wrounding nearest \
    --bwrounding nearest --bfrounding nearest \
    --same_input True --same_weight True

# stochstaic 2
python train_gpt2_hf.py --size 30 --precision finegrain \
    --fnumber 2 --bnumber 2 --wnumber 2 --bwnumber 2 --bfnumber 2 \
    --frounding stochastic --brounding stochastic --wrounding stochastic \
    --bwrounding stochastic --bfrounding stochastic \
    --same_input False --same_weight False

# fp8 2 3
python train_gpt2_hf.py --size 30 --precision finegrain \
    --fnumber 3 --bnumber 2 --wnumber 3 --bwnumber 2 --bfnumber 2 \
    --frounding nearest --brounding nearest --wrounding nearest \
    --bwrounding nearest --bfrounding nearest \
    --same_input True --same_weight True
